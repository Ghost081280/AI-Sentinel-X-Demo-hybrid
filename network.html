<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Network Discovery | AI Sentinel-X</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #00ff88;
            --secondary: #00ccff;
            --accent: #7c3aed;
            --danger: #ff0044;
            --warning: #ffaa00;
            --success: #00ff88;
            --bg-dark: #0a0e1a;
            --bg-darker: #060912;
            --bg-card: rgba(10, 20, 40, 0.8);
            --border: rgba(0, 255, 136, 0.2);
            --text-primary: #ffffff;
            --text-secondary: #8892b0;
            --gradient-1: linear-gradient(135deg, #00ff88 0%, #00ccff 100%);
            --gradient-2: linear-gradient(135deg, #7c3aed 0%, #00ccff 100%);
            --gradient-network: linear-gradient(135deg, #00ccff 0%, #0066ff 100%);
            --gradient-external: linear-gradient(135deg, #ff0044 0%, #ff6644 100%);
            --gradient-internal: linear-gradient(135deg, #00ff88 0%, #00cc66 100%);
            --gradient-encryption: linear-gradient(135deg, #00ff88 0%, #00aa66 100%);
            --gradient-quantum: linear-gradient(135deg, #7c3aed 0%, #ff00ff 50%, #00ccff 100%);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Consolas', 'Monaco', monospace;
            background: var(--bg-darker);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Animated Dot Background */
        .animated-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
            overflow: hidden;
        }

        .dot-grid {
            position: absolute;
            width: 100%;
            height: 100%;
            background-image: radial-gradient(circle, rgba(0, 255, 136, 0.15) 1px, transparent 1px);
            background-size: 30px 30px;
            animation: dotMove 40s linear infinite;
        }

        @keyframes dotMove {
            0% { transform: translate(0, 0); }
            100% { transform: translate(30px, 30px); }
        }

        /* Header */
        .header {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 15px;
            padding: 20px 30px;
            margin: 20px;
            backdrop-filter: blur(15px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
            position: relative;
            z-index: 10;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .brand-title {
            font-size: 24px;
            font-weight: bold;
            background: var(--gradient-network);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            letter-spacing: 2px;
        }

        .page-subtitle {
            color: var(--text-secondary);
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .header-right {
            display: flex;
            gap: 20px;
            align-items: center;
        }

        .agent-status {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 10px 20px;
            background: rgba(0, 255, 136, 0.1);
            border: 1px solid var(--primary);
            border-radius: 30px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .agent-status:hover {
            background: rgba(0, 255, 136, 0.2);
            transform: translateY(-2px);
        }

        .logout-btn {
            background: transparent;
            border: 1px solid rgba(255, 0, 68, 0.3);
            border-radius: 8px;
            padding: 10px 20px;
            color: var(--danger);
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .logout-btn:hover {
            background: rgba(255, 0, 68, 0.1);
        }

        /* Container */
        .container {
            position: relative;
            z-index: 1;
            max-width: 1800px;
            margin: 0 auto;
            padding: 0 20px 20px 20px;
        }

        /* Sub-Agent Status */
        .sub-agent-status {
            background: linear-gradient(135deg, rgba(0, 204, 255, 0.1) 0%, rgba(0, 255, 136, 0.05) 100%);
            border: 1px solid rgba(0, 204, 255, 0.3);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 25px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
        }

        .sub-agent-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .sub-agent-icon {
            width: 50px;
            height: 50px;
            background: var(--gradient-2);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            box-shadow: 0 4px 20px rgba(0, 204, 255, 0.3);
        }

        .sub-agent-details h3 {
            font-size: 18px;
            color: var(--secondary);
            margin-bottom: 5px;
        }

        .sub-agent-details p {
            font-size: 14px;
            color: var(--text-secondary);
        }

        .sub-agent-metrics {
            display: flex;
            gap: 30px;
        }

        .metric {
            text-align: center;
        }

        .metric-value {
            font-size: 24px;
            font-weight: bold;
            color: var(--secondary);
        }

        .metric-label {
            font-size: 12px;
            color: var(--text-secondary);
            text-transform: uppercase;
        }

        /* Compact Encryption Status */
        .encryption-compact {
            background: rgba(124, 58, 237, 0.1);
            border: 1px solid rgba(124, 58, 237, 0.3);
            border-radius: 8px;
            padding: 12px 20px;
            margin-bottom: 25px;
            text-align: center;
            font-size: 14px;
            color: var(--accent);
            font-weight: 600;
        }

        /* Auto Scan Alert */
        .auto-scan-alert {
            background: rgba(0, 204, 255, 0.1);
            border: 2px solid var(--secondary);
            border-radius: 12px;
            padding: 20px 25px;
            margin-bottom: 30px;
            text-align: center;
            font-weight: bold;
            color: var(--secondary);
            font-size: 16px;
        }

        /* Network Overview Section */
        .network-overview {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            backdrop-filter: blur(20px);
        }

        .overview-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--border);
            flex-wrap: wrap;
            gap: 15px;
        }

        .overview-title {
            font-size: 24px;
            font-weight: bold;
            color: var(--primary);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .threat-exposure {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .exposure-label {
            font-size: 14px;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .exposure-rating {
            padding: 8px 20px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .exposure-low {
            background: rgba(0, 255, 136, 0.2);
            color: var(--success);
        }

        .exposure-medium {
            background: rgba(255, 170, 0, 0.2);
            color: var(--warning);
        }

        .exposure-high {
            background: rgba(255, 0, 68, 0.2);
            color: var(--danger);
        }

        .overview-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .overview-card {
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.4) 0%, rgba(0, 255, 136, 0.02) 100%);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .overview-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0, 255, 136, 0.2);
        }

        .overview-icon {
            font-size: 36px;
            margin-bottom: 15px;
        }

        .overview-value {
            font-size: 28px;
            font-weight: bold;
            color: var(--primary);
            margin-bottom: 8px;
            font-family: 'Courier New', monospace;
            word-break: break-all;
        }

        .overview-label {
            font-size: 13px;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* Dual Layer Scanning */
        .scanning-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(450px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        /* Scan Panel */
        .scan-panel {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 15px;
            padding: 25px;
            backdrop-filter: blur(20px);
            position: relative;
            overflow: hidden;
        }

        .scan-panel.external {
            border-color: rgba(255, 0, 68, 0.3);
        }

        .scan-panel.internal {
            border-color: rgba(0, 255, 136, 0.3);
        }

        .panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--border);
            flex-wrap: wrap;
            gap: 10px;
        }

        .panel-title {
            font-size: 22px;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .panel-title.external {
            background: var(--gradient-external);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .panel-title.internal {
            background: var(--gradient-internal);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .scan-status {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 13px;
            font-weight: bold;
            text-transform: uppercase;
        }

        .scan-status.active {
            color: var(--success);
        }

        .status-dot {
            width: 10px;
            height: 10px;
            background: var(--success);
            border-radius: 50%;
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.3); opacity: 0.7; }
        }

        /* Scan Results */
        .scan-results {
            background: linear-gradient(180deg, rgba(0, 0, 0, 0.6) 0%, rgba(0, 204, 255, 0.05) 100%);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .result-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            flex-wrap: wrap;
            gap: 10px;
        }

        .result-item:last-child {
            border-bottom: none;
        }

        .result-label {
            font-size: 14px;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 1px;
            flex: 1;
            min-width: 120px;
        }

        .result-value {
            font-size: 15px;
            font-weight: bold;
            color: var(--text-primary);
            font-family: 'Courier New', monospace;
            text-align: right;
            word-break: break-all;
        }

        /* Service List */
        .service-list {
            display: grid;
            gap: 12px;
            margin-top: 20px;
        }

        .service-item {
            background: rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s ease;
            flex-wrap: wrap;
            gap: 10px;
        }

        .service-item:hover {
            background: rgba(0, 255, 136, 0.05);
            border-color: var(--primary);
            transform: translateX(5px);
        }

        .service-info {
            flex: 1;
            min-width: 200px;
        }

        .service-name {
            font-weight: bold;
            margin-bottom: 5px;
            color: var(--primary);
        }

        .service-details {
            font-size: 13px;
            color: var(--text-secondary);
            margin-bottom: 3px;
        }

        .service-encryption {
            font-size: 12px;
            color: var(--accent);
            font-style: italic;
        }

        .service-status {
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            text-transform: uppercase;
            white-space: nowrap;
        }

        .status-secure {
            background: rgba(0, 255, 136, 0.2);
            color: var(--success);
        }

        .status-vulnerable {
            background: rgba(255, 0, 68, 0.2);
            color: var(--danger);
        }

        .status-warning {
            background: rgba(255, 170, 0, 0.2);
            color: var(--warning);
        }

        .status-monitor {
            background: rgba(255, 170, 0, 0.2);
            color: var(--warning);
        }

        .status-update {
            background: rgba(255, 170, 0, 0.2);
            color: var(--warning);
        }

        /* Device Discovery Section */
        .device-discovery {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 15px;
            padding: 30px;
            backdrop-filter: blur(20px);
        }

        .discovery-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 25px;
        }

        .device-card {
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.4) 0%, rgba(0, 255, 136, 0.02) 100%);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            animation: deviceSlideIn 0.5s ease;
        }

        @keyframes deviceSlideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .device-card:hover {
            background: linear-gradient(135deg, rgba(0, 255, 136, 0.05) 0%, rgba(0, 204, 255, 0.05) 100%);
            border-color: var(--primary);
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(0, 255, 136, 0.2);
        }

        .device-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .device-icon {
            font-size: 32px;
            margin-bottom: 10px;
        }

        .device-name {
            font-weight: bold;
            font-size: 16px;
            color: var(--primary);
        }

        .device-ip {
            font-size: 14px;
            color: var(--text-secondary);
            font-family: 'Courier New', monospace;
            margin-bottom: 10px;
        }

        .device-services {
            font-size: 13px;
            color: var(--text-secondary);
            margin-bottom: 5px;
        }

        .device-ai-status {
            font-size: 12px;
            color: var(--accent);
            font-style: italic;
        }

        .device-encryption {
            font-size: 11px;
            color: var(--success);
            margin-top: 8px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        /* Pulse animation for new devices */
        .device-card.new-device {
            border-color: var(--secondary);
            box-shadow: 0 0 20px rgba(0, 204, 255, 0.3);
            animation: newDevicePulse 2s ease-in-out;
        }

        @keyframes newDevicePulse {
            0%, 100% { 
                border-color: var(--secondary);
                box-shadow: 0 0 20px rgba(0, 204, 255, 0.3);
            }
            50% { 
                border-color: var(--primary);
                box-shadow: 0 0 30px rgba(0, 255, 136, 0.5);
            }
        }

        /* AI Chat Widget */
        .ai-chat-widget {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 1000;
        }

        .ai-chat-toggle {
            width: 70px;
            height: 70px;
            background: var(--gradient-network);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 5px 20px rgba(0, 204, 255, 0.4);
            transition: all 0.3s ease;
            font-size: 32px;
        }

        .ai-chat-toggle:hover {
            transform: scale(1.1) rotate(10deg);
        }

        .ai-chat-window {
            position: absolute;
            bottom: 90px;
            right: 0;
            width: 400px;
            height: 600px;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 20px;
            display: none;
            flex-direction: column;
            overflow: hidden;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(20px);
        }

        .ai-chat-window.active {
            display: flex;
            animation: chatSlideIn 0.3s ease;
        }

        @keyframes chatSlideIn {
            from {
                opacity: 0;
                transform: translateY(20px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .ai-chat-header {
            background: var(--gradient-network);
            color: white;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: bold;
            font-size: 16px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .ai-chat-close {
            cursor: pointer;
            font-size: 24px;
            transition: transform 0.3s ease;
        }

        .ai-chat-close:hover {
            transform: rotate(90deg);
        }

        .cli-mode-indicator {
            background: rgba(255, 170, 0, 0.1);
            border: 1px solid var(--warning);
            border-radius: 8px;
            padding: 10px;
            margin: 0 20px;
            text-align: center;
            font-size: 12px;
            color: var(--warning);
            display: none;
        }

        .cli-mode-indicator.active {
            display: block;
        }

        .ai-chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .ai-message {
            animation: messageSlide 0.3s ease;
        }

        @keyframes messageSlide {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .ai-message-bubble {
            background: rgba(0, 204, 255, 0.1);
            border: 1px solid var(--secondary);
            border-radius: 15px;
            padding: 15px 20px;
            max-width: 80%;
            word-wrap: break-word;
            position: relative;
            backdrop-filter: blur(10px);
        }

        .ai-message-bubble.user {
            background: rgba(0, 255, 136, 0.1);
            border-color: var(--primary);
            align-self: flex-end;
        }

        .ai-message-time {
            font-size: 11px;
            color: var(--text-secondary);
            margin-top: 5px;
        }

        .ai-chat-input-container {
            padding: 20px;
            border-top: 1px solid var(--border);
            display: flex;
            gap: 15px;
            align-items: center;
            background: rgba(0, 0, 0, 0.3);
        }

        .ai-chat-input {
            flex: 1;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--border);
            border-radius: 10px;
            padding: 12px 15px;
            color: var(--text-primary);
            font-size: 14px;
            font-family: inherit;
            transition: all 0.3s ease;
        }

        .ai-chat-input:focus {
            outline: none;
            border-color: var(--secondary);
            background: rgba(0, 204, 255, 0.05);
            box-shadow: 0 0 20px rgba(0, 204, 255, 0.2);
        }

        .ai-chat-send {
            background: var(--gradient-network);
            border: none;
            border-radius: 10px;
            padding: 12px 20px;
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .ai-chat-send:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(0, 204, 255, 0.4);
        }

        /* Agent Shutdown Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            backdrop-filter: blur(5px);
        }

        .modal {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 20px;
            padding: 40px;
            max-width: 500px;
            width: 90%;
            backdrop-filter: blur(20px);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            animation: modalSlideIn 0.3s ease;
        }

        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(-20px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .modal-header {
            text-align: center;
            margin-bottom: 25px;
        }

        .modal-title {
            font-size: 24px;
            font-weight: bold;
            color: var(--warning);
            margin-bottom: 10px;
        }

        .modal-content {
            color: var(--text-secondary);
            line-height: 1.6;
            margin-bottom: 30px;
        }

        .modal-actions {
            display: flex;
            gap: 15px;
            justify-content: center;
        }

        .modal-btn {
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .modal-btn-primary {
            background: var(--gradient-1);
            color: var(--bg-darker);
        }

        .modal-btn-secondary {
            background: transparent;
            border: 2px solid var(--border);
            color: var(--text-secondary);
        }

        .modal-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
        }

        /* Mobile Responsive */
        @media (max-width: 1200px) {
            .scanning-grid {
                grid-template-columns: 1fr;
            }
            
            .discovery-grid {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            }
        }

        @media (max-width: 768px) {
            .container {
                padding: 0 15px 15px 15px;
            }
            
            .header {
                margin: 15px;
                padding: 20px;
            }
            
            .brand-title {
                font-size: 20px;
            }
            
            .page-subtitle {
                font-size: 12px;
            }
            
            .header-content {
                flex-direction: column;
                text-align: center;
            }
            
            .auto-scan-alert {
                font-size: 14px;
                padding: 15px;
            }
            
            .sub-agent-status {
                flex-direction: column;
                text-align: center;
            }
            
            .network-overview {
                padding: 20px 15px;
            }
            
            .overview-header {
                flex-direction: column;
                text-align: center;
            }
            
            .overview-title {
                font-size: 20px;
            }
            
            .overview-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 10px;
            }
            
            .overview-card {
                padding: 15px 10px;
            }
            
            .overview-icon {
                font-size: 28px;
                margin-bottom: 10px;
            }
            
            .overview-value {
                font-size: 18px;
            }
            
            .overview-label {
                font-size: 11px;
            }
            
            .scan-panel {
                padding: 20px 15px;
            }
            
            .panel-title {
                font-size: 18px;
            }
            
            .scan-results {
                padding: 15px;
            }
            
            .result-item {
                padding: 10px 0;
            }
            
            .result-label {
                font-size: 12px;
            }
            
            .result-value {
                font-size: 13px;
            }
            
            .service-item {
                padding: 12px;
            }
            
            .service-info {
                min-width: 150px;
            }
            
            .service-name {
                font-size: 14px;
            }
            
            .service-details {
                font-size: 12px;
            }
            
            .device-discovery {
                padding: 20px 15px;
            }
            
            .discovery-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .device-card {
                padding: 15px;
            }
            
            .ai-chat-widget {
                bottom: 20px;
                right: 20px;
            }
            
            .ai-chat-toggle {
                width: 60px;
                height: 60px;
                font-size: 28px;
            }
            
            .ai-chat-window {
                width: calc(100vw - 20px);
                height: calc(100vh - 120px);
                right: -10px;
                bottom: 80px;
            }
            
            .ai-chat-input {
                font-size: 14px;
                padding: 10px 12px;
            }
            
            .ai-chat-send {
                padding: 10px 15px;
                font-size: 13px;
            }
        }

        @media (max-width: 480px) {
            .brand-title {
                font-size: 18px;
            }
            
            .overview-grid {
                grid-template-columns: 1fr;
            }
            
            .overview-value {
                font-size: 20px;
            }
            
            .panel-header {
                gap: 15px;
            }
            
            .panel-title {
                font-size: 16px;
            }
            
            .scan-status {
                font-size: 11px;
            }
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb {
            background: var(--secondary);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--primary);
        }
    </style>
</head>
<body>
    <script>
        // Check authentication
        const auth = localStorage.getItem('sentinel_auth');
        if (!auth) {
            window.location.href = 'index.html';
        } else {
            const authData = JSON.parse(auth);
            if (Date.now() - authData.timestamp > 24 * 60 * 60 * 1000) {
                localStorage.removeItem('sentinel_auth');
                window.location.href = 'index.html';
            }
        }
    </script>

    <!-- Animated Background -->
    <div class="animated-bg">
        <div class="dot-grid"></div>
    </div>

    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div class="header-left">
                <div>
                    <h1 class="brand-title">AI SENTINEL-X | NETWORK DISCOVERY</h1>
                    <p class="page-subtitle">NetworkMapper Sub-Agent Active</p>
                </div>
            </div>
            <div class="header-right">
                <div class="agent-status" onclick="showAgentShutdownModal()">
                    <span>🤖 AI Agent Active • Fully Autonomous</span>
                </div>
                <button class="logout-btn" onclick="handleLogout()">Logout</button>
            </div>
        </div>
    </header>

    <!-- Container -->
    <div class="container">
        <!-- Sub-Agent Status -->
        <div class="sub-agent-status">
            <div class="sub-agent-info">
                <div class="sub-agent-icon">🌐</div>
                <div class="sub-agent-details">
                    <h3>NetworkMapper Sub-Agent</h3>
                    <p>Dual-layer scanning • External + Internal • Reports to Main Agent</p>
                </div>
            </div>
            <div class="sub-agent-metrics">
                <div class="metric">
                    <div class="metric-value" id="discoveredDevices">247</div>
                    <div class="metric-label">Devices</div>
                </div>
                <div class="metric">
                    <div class="metric-value" id="openServices">42</div>
                    <div class="metric-label">Services</div>
                </div>
                <div class="metric">
                    <div class="metric-value" id="newDevices">12</div>
                    <div class="metric-label">New (24h)</div>
                </div>
            </div>
        </div>

        <!-- Compact Encryption Status -->
        <div class="encryption-compact">
            🔒 CLASSICAL + QUANTUM ACTIVE
        </div>

        <!-- Auto Scan Alert -->
        <div class="auto-scan-alert">
            🤖 Autonomous dual-layer scanning active • External reconnaissance via Shodan API • Internal discovery via deployed agent • No manual intervention required
        </div>

        <!-- Network Overview -->
        <div class="network-overview">
            <div class="overview-header">
                <h2 class="overview-title">Network Scan Overview</h2>
                <div class="threat-exposure">
                    <span class="exposure-label">Threat Exposure:</span>
                    <span class="exposure-rating exposure-medium" id="exposureRating">MEDIUM</span>
                </div>
            </div>
            
            <div class="overview-grid">
                <div class="overview-card">
                    <div class="overview-icon">🌐</div>
                    <div class="overview-value" id="publicIP">45.67.89.123</div>
                    <div class="overview-label">Public IP Address</div>
                </div>
                <div class="overview-card">
                    <div class="overview-icon">🏠</div>
                    <div class="overview-value" id="internalSubnet">192.168.1.0/24</div>
                    <div class="overview-label">Internal Subnet</div>
                </div>
                <div class="overview-card">
                    <div class="overview-icon">📡</div>
                    <div class="overview-value" id="discoveredDevicesCard">246</div>
                    <div class="overview-label">Discovered Devices</div>
                </div>
                <div class="overview-card">
                    <div class="overview-icon">⚠️</div>
                    <div class="overview-value" id="openServicesCard">42</div>
                    <div class="overview-label">Open Services</div>
                </div>
            </div>
        </div>

        <!-- Dual Layer Scanning -->
        <div class="scanning-grid">
            <!-- External Scan Panel -->
            <div class="scan-panel external">
                <div class="panel-header">
                    <h2 class="panel-title external">External Scan (Shodan)</h2>
                    <div class="scan-status active">
                        <div class="status-dot"></div>
                        <span>SCANNING</span>
                    </div>
                </div>
                
                <div class="scan-results">
                    <div class="result-item">
                        <span class="result-label">Organization</span>
                        <span class="result-value" id="orgName">Acme Corporation</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">ISP</span>
                        <span class="result-value" id="ispName">Business Fiber Network</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">Location</span>
                        <span class="result-value" id="location">Columbia, SC, US</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">Open Ports</span>
                        <span class="result-value" id="openPorts" style="color: var(--warning);">7</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">Vulnerabilities</span>
                        <span class="result-value" id="vulnCount" style="color: var(--danger);">2</span>
                    </div>
                </div>

                <div class="service-list">
                    <div class="service-item">
                        <div class="service-info">
                            <div class="service-name">HTTPS (443/tcp)</div>
                            <div class="service-details">nginx/1.18.0 • TLS 1.3</div>
                            <div class="service-encryption">🔐 AES-256-GCM + CRYSTALS-Kyber</div>
                        </div>
                        <div class="service-status status-secure">SECURE</div>
                    </div>
                    <div class="service-item">
                        <div class="service-info">
                            <div class="service-name">SSH (22/tcp)</div>
                            <div class="service-details">OpenSSH_7.4 • Key Auth Only</div>
                            <div class="service-encryption">🔐 Hybrid: Classical + PQ Keys</div>
                        </div>
                        <div class="service-status status-secure">SECURE</div>
                    </div>
                    <div class="service-item">
                        <div class="service-info">
                            <div class="service-name">RDP (3389/tcp)</div>
                            <div class="service-details">Windows Server 2019 • NLA + TLS 1.2</div>
                            <div class="service-encryption">⚠️ Classical only - upgrade needed</div>
                        </div>
                        <div class="service-status status-monitor">MONITOR</div>
                    </div>
                    <div class="service-item">
                        <div class="service-info">
                            <div class="service-name">SMB (445/tcp)</div>
                            <div class="service-details">SMBv2 • Outdated</div>
                            <div class="service-encryption">❌ Weak encryption</div>
                        </div>
                        <div class="service-status status-vulnerable">VULNERABLE</div>
                    </div>
                </div>
            </div>

            <!-- Internal Scan Panel -->
            <div class="scan-panel internal">
                <div class="panel-header">
                    <h2 class="panel-title internal">Internal Scan (Agent)</h2>
                    <div class="scan-status active">
                        <div class="status-dot"></div>
                        <span>AUTO-DISCOVERING</span>
                    </div>
                </div>
                
                <div class="scan-results">
                    <div class="result-item">
                        <span class="result-label">Network Range</span>
                        <span class="result-value">192.168.1.0/24</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">Active Hosts</span>
                        <span class="result-value" id="activeHosts" style="color: var(--success);">246</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">New Devices (24h)</span>
                        <span class="result-value" id="newDevicesInternal" style="color: var(--secondary);">14</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">Unpatched Systems</span>
                        <span class="result-value" id="unpatchedSystems" style="color: var(--warning);">18</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">AI Monitoring</span>
                        <span class="result-value" style="color: var(--accent);">REAL-TIME</span>
                    </div>
                </div>

                <div class="service-list">
                    <div class="service-item">
                        <div class="service-info">
                            <div class="service-name">Domain Controllers</div>
                            <div class="service-details">2 servers • AD DS • Kerberos</div>
                            <div class="service-encryption">🔐 Full hybrid encryption</div>
                        </div>
                        <div class="service-status status-secure">SECURE</div>
                    </div>
                    <div class="service-item">
                        <div class="service-info">
                            <div class="service-name">Database Servers</div>
                            <div class="service-details">5 instances • TDE enabled</div>
                            <div class="service-encryption">🔐 AES-256 + Kyber-1024</div>
                        </div>
                        <div class="service-status status-secure">SECURE</div>
                    </div>
                    <div class="service-item">
                        <div class="service-info">
                            <div class="service-name">IoT Devices</div>
                            <div class="service-details">47 devices • Mixed security</div>
                            <div class="service-encryption">⚠️ Partial encryption support</div>
                        </div>
                        <div class="service-status status-monitor">MONITOR</div>
                    </div>
                    <div class="service-item">
                        <div class="service-info">
                            <div class="service-name">Workstations</div>
                            <div class="service-details">189 systems • BitLocker enabled</div>
                            <div class="service-encryption">🔐 Hybrid disk encryption</div>
                        </div>
                        <div class="service-status status-update">UPDATE</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Device Discovery -->
        <div class="device-discovery">
            <div class="panel-header">
                <h2 class="panel-title">Live Device Discovery</h2>
                <span style="color: var(--text-secondary); font-size: 14px;">Auto-updating every 3 seconds</span>
            </div>
            
            <div class="discovery-grid" id="deviceGrid">
                <!-- Devices will be populated here -->
            </div>
        </div>
    </div>

    <!-- Agent Shutdown Modal -->
    <div class="modal-overlay" id="agentShutdownModal" onclick="closeModalOnOverlay(event)">
        <div class="modal">
            <div class="modal-header">
                <h2 class="modal-title">⚠️ Emergency AI Shutdown</h2>
            </div>
            <div class="modal-content">
                Pause autonomous mode? AI actions will be disabled, but manual control remains available through the AI chat bot. If external APIs or keys are offline, the agent will fallback to local control mode.
            </div>
            <div class="modal-actions">
                <button class="modal-btn modal-btn-primary" onclick="confirmAgentShutdown()">Confirm Shutdown</button>
                <button class="modal-btn modal-btn-secondary" onclick="closeModal()">Cancel</button>
            </div>
        </div>
    </div>

    <!-- AI Chat Widget -->
    <div class="ai-chat-widget">
        <div class="ai-chat-window" id="aiChatWindow">
            <div class="ai-chat-header">
                <span>NETWORK SCANNER AI</span>
                <span class="ai-chat-close" onclick="toggleChat()">×</span>
            </div>
            <div class="cli-mode-indicator" id="cliModeIndicator">
                ⚠️ CLI MODE - Main Agent Offline
            </div>
            <div class="ai-chat-messages" id="aiChatMessages">
                <div class="ai-message">
                    <div class="ai-message-bubble">
                        I'm conducting dual-layer network analysis with quantum-resistant encryption. External scan via Shodan shows your public attack surface. Internal agent discovered 246 devices automatically. All communications secured with AES-256-GCM + CRYSTALS-Kyber. How can I help analyze your network?
                    </div>
                    <div class="ai-message-time">Just now</div>
                </div>
            </div>
            <div class="ai-chat-input-container">
                <input 
                    type="text" 
                    class="ai-chat-input" 
                    id="aiChatInput" 
                    placeholder="Ask about external exposure, internal devices, or hybrid encryption status..."
                    onkeypress="handleChatKeyPress(event)"
                >
                <button class="ai-chat-send" onclick="sendChatMessage()">SEND</button>
            </div>
        </div>
        <div class="ai-chat-toggle" onclick="toggleChat()">🤖</div>
    </div>

    <script src="shared.js"></script>
    <script>
        // Sample devices for demonstration
        let internalDevices = [
            { 
                id: 'dc-primary', 
                name: 'DC-PRIMARY', 
                ip: '192.168.1.10', 
                type: 'Domain Controller', 
                icon: '🖥️', 
                services: 'AD, DNS, DHCP', 
                status: 'Secure', 
                encryption: 'Hybrid: AES-256 + Kyber',
                isNew: false 
            },
            { 
                id: 'dc-secondary', 
                name: 'DC-SECONDARY', 
                ip: '192.168.1.11', 
                type: 'Domain Controller', 
                icon: '🖥️', 
                services: 'AD, DNS', 
                status: 'Secure', 
                encryption: 'Hybrid: AES-256 + Kyber',
                isNew: false 
            },
            { 
                id: 'file-server-01', 
                name: 'FILE-SERVER-01', 
                ip: '192.168.1.20', 
                type: 'File Server', 
                icon: '📁', 
                services: 'SMB, FTP', 
                status: 'Monitoring', 
                encryption: 'AES-256-GCM',
                isNew: false 
            },
            { 
                id: 'db-prod-01', 
                name: 'DB-PROD-01', 
                ip: '192.168.1.30', 
                type: 'Database', 
                icon: '🗄️', 
                services: 'MySQL 8.0', 
                status: 'Secure', 
                encryption: 'TDE: AES-256 + Kyber',
                isNew: false 
            },
            { 
                id: 'web-app-01', 
                name: 'WEB-APP-01', 
                ip: '192.168.1.40', 
                type: 'Web Server', 
                icon: '🌐', 
                services: 'HTTPS, SSH', 
                status: 'Secure', 
                encryption: 'TLS 1.3 + PQ Certs',
                isNew: false 
            },
            { 
                id: 'security-cam-01', 
                name: 'SECURITY-CAM-01', 
                ip: '192.168.1.50', 
                type: 'IoT Device', 
                icon: '📹', 
                services: 'RTSP, HTTP', 
                status: 'Vulnerable', 
                encryption: 'Weak/None',
                isNew: false 
            },
            { 
                id: 'workstation-101', 
                name: 'WORKSTATION-101', 
                ip: '192.168.1.101', 
                type: 'Workstation', 
                icon: '💻', 
                services: 'RDP, SMB', 
                status: 'Update Required', 
                encryption: 'BitLocker: Hybrid',
                isNew: false 
            },
            { 
                id: 'printer-finance', 
                name: 'PRINTER-FINANCE', 
                ip: '192.168.1.200', 
                type: 'Network Printer', 
                icon: '🖨️', 
                services: 'IPP, SNMP', 
                status: 'Default Password', 
                encryption: 'TLS Optional',
                isNew: false 
            },
            { 
                id: 'hvac-controller', 
                name: 'HVAC-CONTROLLER', 
                ip: '192.168.1.230', 
                type: 'Building System', 
                icon: '🌡️', 
                services: 'BACnet, HTTP', 
                status: 'Monitoring', 
                encryption: 'Basic Auth',
                isNew: false 
            }
        ];

        // Additional device pool for dynamic discovery
        const devicePool = [
            { name: 'LAPTOP-USER-{ID}', type: 'Workstation', icon: '💻', services: 'SMB, SSH', status: 'Scanning', encryption: 'BitLocker: AES-256' },
            { name: 'PHONE-MOBILE-{ID}', type: 'Mobile Device', icon: '📱', services: 'WiFi, VPN', status: 'Connected', encryption: 'WPA3 + TLS' },
            { name: 'IOT-SENSOR-{ID}', type: 'IoT Device', icon: '🔆', services: 'MQTT, HTTP', status: 'Monitoring', encryption: 'Basic TLS' },
            { name: 'TABLET-CONF-{ID}', type: 'Tablet', icon: '📲', services: 'WiFi, RDP', status: 'Active', encryption: 'Device Encryption' },
            { name: 'CAMERA-HALL-{ID}', type: 'Security Camera', icon: '📹', services: 'RTSP, ONVIF', status: 'Recording', encryption: 'WEP (Weak)' },
            { name: 'SWITCH-FLOOR-{ID}', type: 'Network Switch', icon: '🔄', services: 'SNMP, Telnet', status: 'Managed', encryption: 'SNMPv3' },
            { name: 'ACCESS-POINT-{ID}', type: 'Wireless AP', icon: '📶', services: 'WiFi, HTTP', status: 'Broadcasting', encryption: 'WPA3-Enterprise' },
            { name: 'NAS-BACKUP-{ID}', type: 'Storage', icon: '💾', services: 'FTP, SMB', status: 'Backup Active', encryption: 'AES-256 + Kyber' }
        ];

        let deviceCounter = 250;
        let discoveryActive = true;

        // Populate device grid
        function populateDeviceGrid() {
            const grid = document.getElementById('deviceGrid');
            if (!grid) return;
            
            grid.innerHTML = '';
            
            internalDevices.forEach((device, index) => {
                const card = document.createElement('div');
                card.className = `device-card ${device.isNew ? 'new-device' : ''}`;
                card.innerHTML = `
                    <div class="device-header">
                        <div class="device-icon">${device.icon}</div>
                    </div>
                    <div class="device-name">${device.name}</div>
                    <div class="device-ip">${device.ip}</div>
                    <div class="device-services">Services: ${device.services}</div>
                    <div class="device-ai-status">AI Status: ${device.status}</div>
                    <div class="device-encryption">
                        <span>🔒</span>
                        <span>Encryption: ${device.encryption}</span>
                    </div>
                `;
                card.style.animationDelay = `${index * 0.1}s`;
                card.onclick = () => showDeviceDetails(device);
                grid.appendChild(card);
                
                // Remove new device class after animation
                if (device.isNew) {
                    setTimeout(() => {
                        device.isNew = false;
                        card.classList.remove('new-device');
                    }, 2000);
                }
            });
        }

        // Show device details
        function showDeviceDetails(device) {
            if (!chatOpen) {
                toggleChat();
            }
            setTimeout(() => {
                let encryptionStatus = '';
                if (device.encryption.includes('Hybrid') || device.encryption.includes('Kyber')) {
                    encryptionStatus = '✅ Quantum-resistant encryption with ' + device.encryption;
                } else if (device.encryption.includes('AES-256')) {
                    encryptionStatus = '🔒 Strong classical encryption: ' + device.encryption;
                } else if (device.encryption.includes('Weak') || device.encryption.includes('None')) {
                    encryptionStatus = '⚠️ WARNING: Weak or no encryption. Immediate upgrade to hybrid encryption recommended!';
                } else {
                    encryptionStatus = '🔒 Encryption: ' + device.encryption;
                }
                
                addChatMessage(`NetworkMapper: Analyzing ${device.name} (${device.ip}) - Type: ${device.type}, Services: ${device.services}. Status: ${device.status}. ${encryptionStatus} ${device.status.includes('Vulnerable') ? 'Immediate action recommended!' : 'Being monitored by AI.'}`, false);
            }, 300);
        }

        // Add new device to discovery
        function addNewDevice() {
            if (!discoveryActive) return;
            
            const template = devicePool[Math.floor(Math.random() * devicePool.length)];
            const deviceId = deviceCounter++;
            
            const newDevice = {
                id: `device-${deviceId}`,
                name: template.name.replace('{ID}', String(deviceId).padStart(2, '0')),
                ip: `192.168.1.${Math.floor(Math.random() * 200) + 50}`,
                type: template.type,
                icon: template.icon,
                services: template.services,
                status: template.status,
                encryption: template.encryption,
                isNew: true
            };
            
            internalDevices.push(newDevice);
            
            // Update metrics
            updateNewDeviceMetrics();
            
            // Repopulate grid to show new device with animation
            populateDeviceGrid();
            
            // Show in chat if open
            if (chatOpen && Math.random() > 0.7) {
                setTimeout(() => {
                    addChatMessage(`NetworkMapper: New device discovered - ${newDevice.name} (${newDevice.ip}). Scanning services and encryption capabilities...`, false);
                }, 1000);
            }
        }

        // Update metrics when new device found
        function updateNewDeviceMetrics() {
            const discovered = document.getElementById('discoveredDevices');
            const current = parseInt(discovered.textContent);
            discovered.textContent = current + 1;
            
            const discoveredCard = document.getElementById('discoveredDevicesCard');
            discoveredCard.textContent = discovered.textContent;
            
            const newDev = document.getElementById('newDevices');
            newDev.textContent = parseInt(newDev.textContent) + 1;
            
            const newDevInt = document.getElementById('newDevicesInternal');
            newDevInt.textContent = newDev.textContent;
            
            const activeHosts = document.getElementById('activeHosts');
            activeHosts.textContent = discovered.textContent;
        }

        // Update metrics
        function updateMetrics() {
            // Simulate real-time updates
            const services = document.getElementById('openServices');
            services.textContent = Math.floor(40 + Math.random() * 5);
            
            // Update card values to match
            document.getElementById('openServicesCard').textContent = services.textContent;
            
            // Update threat exposure based on vulnerabilities
            const vulns = parseInt(document.getElementById('vulnCount').textContent);
            const unpatched = parseInt(document.getElementById('unpatchedSystems').textContent);
            const rating = document.getElementById('exposureRating');
            
            if (vulns > 3 || unpatched > 20) {
                rating.textContent = 'HIGH';
                rating.className = 'exposure-rating exposure-high';
            } else if (vulns > 0 || unpatched > 10) {
                rating.textContent = 'MEDIUM';
                rating.className = 'exposure-rating exposure-medium';
            } else {
                rating.textContent = 'LOW';
                rating.className = 'exposure-rating exposure-low';
            }
        }

        // Start/stop discovery
        function toggleDiscovery() {
            discoveryActive = !discoveryActive;
            if (chatOpen) {
                const status = discoveryActive ? 'resumed' : 'paused';
                addChatMessage(`NetworkMapper: Device discovery ${status}. Discovery mode: ${discoveryActive ? 'ACTIVE' : 'PAUSED'}`, false, 'system');
            }
        }

        // Logout handler
        function handleLogout() {
            if (confirm('Logout? The AI agent will continue protecting your systems.')) {
                localStorage.removeItem('sentinel_auth');
                window.location.href = 'index.html';
            }
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            populateDeviceGrid();
            
            // Auto-update metrics every 3 seconds
            setInterval(() => {
                updateMetrics();
            }, 3000);
            
            // Simulate discovering new devices every 8-15 seconds
            setInterval(() => {
                if (Math.random() > 0.4 && discoveryActive) {
                    addNewDevice();
                }
            }, Math.random() * 7000 + 8000);
            
            // Add periodic network events to chat
            setInterval(() => {
                if (Math.random() > 0.85 && chatOpen) {
                    const events = [
                        '🌐 NetworkMapper: External scan update - New service detected on port 8080 with quantum-resistant TLS 1.3.',
                        '📡 NetworkMapper: Internal discovery - New device joined network, checking hybrid encryption support...',
                        '🔒 NetworkMapper: Security update - Vulnerable device upgraded to AES-256-GCM + Kyber.',
                        '✅ NetworkMapper: Quantum-ready status - 3 systems upgraded to hybrid BitLocker encryption.',
                        '🛡️ NetworkMapper: Firewall rule suggested to protect non-quantum-ready IoT device.',
                        '🔬 NetworkMapper: Hybrid encryption verification - Domain controllers fully quantum-protected.',
                        '⚡ NetworkMapper: Performance check - Quantum algorithms running efficiently on all critical systems.'
                    ];
                    addChatMessage(events[Math.floor(Math.random() * events.length)], false);
                }
            }, 25000);
        });

        // Agent shutdown modal functions
        function showAgentShutdownModal() {
            const modal = document.getElementById('agentShutdownModal');
            if (modal) {
                modal.style.display = 'flex';
            }
        }

        function closeModal() {
            const modal = document.getElementById('agentShutdownModal');
            if (modal) {
                modal.style.display = 'none';
            }
        }

        function closeModalOnOverlay(event) {
            if (event.target === event.currentTarget) {
                closeModal();
            }
        }

        function confirmAgentShutdown() {
            agentActive = false;
            discoveryActive = false;
            
            // Update header status
            const agentStatus = document.querySelector('.agent-status');
            if (agentStatus) {
                agentStatus.style.background = 'rgba(255, 170, 0, 0.1)';
                agentStatus.style.borderColor = '#ffaa00';
                agentStatus.innerHTML = '<span>⚠️ AI Agent Paused • Manual Control Only</span>';
            }
            
            closeModal();
            
            // Show notification in chat
            if (chatOpen) {
                addChatMessage('⚠️ NetworkMapper: Main Agent has been paused. Device discovery stopped. Manual control is now active.', false, 'system');
            }
        }
    </script>
</body>
</html>
