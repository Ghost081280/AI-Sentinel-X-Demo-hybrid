<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Active Defense | AI Sentinel-X</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #00ff88;
            --secondary: #00ccff;
            --accent: #7c3aed;
            --danger: #ff0044;
            --warning: #ffaa00;
            --success: #00ff88;
            --bg-dark: #0a0e1a;
            --bg-darker: #060912;
            --bg-card: rgba(10, 20, 40, 0.8);
            --border: rgba(0, 255, 136, 0.2);
            --text-primary: #ffffff;
            --text-secondary: #8892b0;
            --gradient-1: linear-gradient(135deg, #00ff88 0%, #00ccff 100%);
            --gradient-defense: linear-gradient(135deg, #00ff88 0%, #00aa66 100%);
            --gradient-quantum: linear-gradient(135deg, #7c3aed 0%, #ff00ff 50%, #00ccff 100%);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Consolas', 'Monaco', monospace;
            background: var(--bg-darker);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Animated Dot Background */
        .animated-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
            overflow: hidden;
        }

        .dot-grid {
            position: absolute;
            width: 100%;
            height: 100%;
            background-image: radial-gradient(circle, rgba(0, 255, 136, 0.15) 1px, transparent 1px);
            background-size: 30px 30px;
            animation: dotMove 40s linear infinite;
        }

        @keyframes dotMove {
            0% { transform: translate(0, 0); }
            100% { transform: translate(30px, 30px); }
        }

        /* Header */
        .header {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 15px;
            padding: 20px 30px;
            margin: 20px;
            backdrop-filter: blur(15px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
            position: relative;
            z-index: 10;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .brand-title {
            font-size: 24px;
            font-weight: bold;
            background: var(--gradient-1);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            letter-spacing: 2px;
        }

        .page-subtitle {
            color: var(--text-secondary);
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .header-right {
            display: flex;
            gap: 20px;
            align-items: center;
        }

        .agent-status {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 10px 20px;
            background: rgba(0, 255, 136, 0.1);
            border: 1px solid var(--primary);
            border-radius: 30px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .agent-status:hover {
            background: rgba(0, 255, 136, 0.2);
            transform: translateY(-2px);
        }

        .logout-btn {
            background: transparent;
            border: 1px solid rgba(255, 0, 68, 0.3);
            border-radius: 8px;
            padding: 10px 20px;
            color: var(--danger);
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .logout-btn:hover {
            background: rgba(255, 0, 68, 0.1);
        }

        /* Container */
        .container {
            position: relative;
            z-index: 1;
            max-width: 1800px;
            margin: 0 auto;
            padding: 0 20px 20px 20px;
        }

        /* Sub-Agent Status */
        .sub-agent-status {
            background: linear-gradient(135deg, rgba(0, 255, 136, 0.1) 0%, rgba(0, 170, 102, 0.05) 100%);
            border: 1px solid rgba(0, 255, 136, 0.3);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 25px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
        }

        .sub-agent-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .sub-agent-icon {
            width: 50px;
            height: 50px;
            background: var(--gradient-defense);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            box-shadow: 0 4px 20px rgba(0, 255, 136, 0.3);
        }

        .sub-agent-details h3 {
            font-size: 18px;
            color: var(--primary);
            margin-bottom: 5px;
        }

        .sub-agent-details p {
            font-size: 14px;
            color: var(--text-secondary);
        }

        .sub-agent-metrics {
            display: flex;
            gap: 30px;
        }

        .metric {
            text-align: center;
        }

        .metric-value {
            font-size: 24px;
            font-weight: bold;
            color: var(--primary);
        }

        .metric-label {
            font-size: 12px;
            color: var(--text-secondary);
            text-transform: uppercase;
        }

        /* Compact Encryption Status */
        .encryption-compact {
            background: rgba(124, 58, 237, 0.1);
            border: 1px solid rgba(124, 58, 237, 0.3);
            border-radius: 8px;
            padding: 12px 20px;
            margin-bottom: 25px;
            text-align: center;
            font-size: 14px;
            color: var(--accent);
            font-weight: 600;
        }

        /* Defense Status Bar */
        .defense-status-bar {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 25px;
            display: flex;
            justify-content: space-around;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
            backdrop-filter: blur(15px);
        }

        .status-item {
            text-align: center;
        }

        .status-icon {
            font-size: 32px;
            margin-bottom: 10px;
        }

        .status-label {
            font-size: 13px;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .status-value {
            font-size: 20px;
            font-weight: bold;
            color: var(--primary);
        }

        /* Main Grid */
        .defense-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
            margin-bottom: 30px;
        }

        /* Honeypot Panel */
        .honeypot-panel {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 15px;
            padding: 25px;
            backdrop-filter: blur(20px);
        }

        .panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--border);
        }

        .panel-title {
            font-size: 20px;
            font-weight: bold;
            color: var(--primary);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .honeypot-list {
            display: grid;
            gap: 15px;
        }

        .honeypot-item {
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.4) 0%, rgba(0, 255, 136, 0.02) 100%);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .honeypot-item:hover {
            background: linear-gradient(135deg, rgba(0, 255, 136, 0.05) 0%, rgba(0, 170, 102, 0.05) 100%);
            border-color: var(--primary);
            transform: translateX(5px);
        }

        .honeypot-info {
            flex: 1;
        }

        .honeypot-name {
            font-weight: bold;
            font-size: 16px;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 8px;
        }

        .honeypot-details {
            font-size: 14px;
            color: var(--text-secondary);
            margin-bottom: 5px;
        }

        .honeypot-ai-status {
            font-size: 13px;
            color: var(--accent);
            font-style: italic;
        }

        .honeypot-status {
            padding: 8px 16px;
            background: rgba(0, 255, 136, 0.2);
            color: var(--success);
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            text-transform: uppercase;
        }

        .status-inactive {
            background: rgba(255, 170, 0, 0.2);
            color: var(--warning);
        }

        /* Response Timeline */
        .timeline-panel {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 15px;
            padding: 25px;
            backdrop-filter: blur(20px);
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        .timeline-container {
            flex: 1;
            overflow-y: auto;
            padding-right: 10px;
        }

        .timeline-event {
            display: flex;
            gap: 20px;
            margin-bottom: 25px;
            padding-bottom: 25px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            animation: timelineSlide 0.5s ease;
        }

        @keyframes timelineSlide {
            from { opacity: 0; transform: translateX(-20px); }
            to { opacity: 1; transform: translateX(0); }
        }

        .timeline-icon {
            width: 50px;
            height: 50px;
            background: var(--gradient-1);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            font-size: 24px;
            box-shadow: 0 0 20px rgba(0, 255, 136, 0.3);
        }

        .timeline-content {
            flex: 1;
        }

        .timeline-time {
            font-size: 13px;
            color: var(--text-secondary);
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .timeline-action {
            font-weight: bold;
            color: var(--primary);
            margin-bottom: 8px;
            font-size: 16px;
        }

        .timeline-details {
            font-size: 14px;
            color: var(--text-primary);
            line-height: 1.5;
        }

        .timeline-agent {
            font-size: 12px;
            color: var(--accent);
            margin-top: 8px;
            font-style: italic;
        }

        /* Playbooks Section */
        .playbooks-section {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 15px;
            padding: 30px;
            backdrop-filter: blur(20px);
        }

        .playbook-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 25px;
        }

        .playbook-card {
            background: linear-gradient(135deg, rgba(0, 255, 136, 0.1) 0%, rgba(0, 204, 255, 0.05) 100%);
            border: 1px solid rgba(0, 255, 136, 0.3);
            border-radius: 12px;
            padding: 25px;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .playbook-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 255, 136, 0.2);
        }

        .playbook-icon {
            font-size: 48px;
            margin-bottom: 15px;
        }

        .playbook-name {
            font-weight: bold;
            margin-bottom: 10px;
            color: var(--primary);
            font-size: 16px;
        }

        .playbook-stats {
            font-size: 13px;
            color: var(--text-secondary);
            margin-bottom: 10px;
        }

        .playbook-agent {
            font-size: 12px;
            color: var(--accent);
            font-style: italic;
        }

        /* AI Chat Widget */
        .ai-chat-widget {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 1000;
        }

        .ai-chat-toggle {
            width: 60px;
            height: 60px;
            background: var(--gradient-1);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 5px 20px rgba(0, 255, 136, 0.4);
            transition: all 0.3s ease;
            font-size: 28px;
        }

        .ai-chat-toggle:hover {
            transform: scale(1.1);
        }

        .ai-chat-window {
            position: absolute;
            bottom: 80px;
            right: 0;
            width: 400px;
            height: 600px;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 20px;
            display: none;
            flex-direction: column;
            overflow: hidden;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(20px);
        }

        .ai-chat-window.active {
            display: flex;
            animation: chatSlideIn 0.3s ease;
        }

        @keyframes chatSlideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .ai-chat-header {
            background: var(--gradient-1);
            color: var(--bg-darker);
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: bold;
        }

        .ai-chat-status {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 14px;
        }

        .chat-status-dot {
            width: 8px;
            height: 8px;
            background: var(--bg-darker);
            border-radius: 50%;
            animation: pulse 2s ease-in-out infinite;
        }

        .ai-chat-close {
            cursor: pointer;
            font-size: 24px;
        }

        .cli-mode-indicator {
            background: rgba(255, 170, 0, 0.1);
            border: 1px solid var(--warning);
            border-radius: 8px;
            padding: 10px;
            margin: 0 20px;
            text-align: center;
            font-size: 12px;
            color: var(--warning);
            display: none;
        }

        .cli-mode-indicator.active {
            display: block;
        }

        .ai-chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .ai-message-bubble {
            background: rgba(0, 255, 136, 0.1);
            border: 1px solid var(--border);
            border-radius: 15px;
            padding: 15px 20px;
            max-width: 80%;
            word-wrap: break-word;
        }

        .ai-message-bubble.user {
            background: rgba(0, 204, 255, 0.1);
            border-color: var(--secondary);
            align-self: flex-end;
        }

        .ai-message-bubble.system {
            background: rgba(124, 58, 237, 0.1);
            border-color: var(--accent);
            font-size: 13px;
            font-style: italic;
        }

        .ai-message-time {
            font-size: 11px;
            color: var(--text-secondary);
            margin-top: 5px;
        }

        .ai-chat-input-container {
            padding: 20px;
            border-top: 1px solid var(--border);
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .ai-chat-input {
            flex: 1;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--border);
            border-radius: 10px;
            padding: 12px 15px;
            color: var(--text-primary);
            font-size: 14px;
        }

        .ai-chat-input:focus {
            outline: none;
            border-color: var(--primary);
        }

        .ai-chat-send {
            background: var(--gradient-1);
            border: none;
            border-radius: 10px;
            padding: 12px 20px;
            color: var(--bg-darker);
            font-weight: bold;
            cursor: pointer;
            text-transform: uppercase;
        }

        /* Agent Shutdown Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            backdrop-filter: blur(5px);
        }

        .modal {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 20px;
            padding: 40px;
            max-width: 500px;
            width: 90%;
            backdrop-filter: blur(20px);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            animation: modalSlideIn 0.3s ease;
        }

        @keyframes modalSlideIn {
            from { opacity: 0; transform: translateY(-20px) scale(0.95); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }

        .modal-header {
            text-align: center;
            margin-bottom: 25px;
        }

        .modal-title {
            font-size: 24px;
            font-weight: bold;
            color: var(--warning);
            margin-bottom: 10px;
        }

        .modal-content {
            color: var(--text-secondary);
            line-height: 1.6;
            margin-bottom: 30px;
        }

        .modal-actions {
            display: flex;
            gap: 15px;
            justify-content: center;
        }

        .modal-btn {
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .modal-btn-primary {
            background: var(--gradient-1);
            color: var(--bg-darker);
        }

        .modal-btn-secondary {
            background: transparent;
            border: 2px solid var(--border);
            color: var(--text-secondary);
        }

        .modal-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
        }

        /* Mobile Responsive */
        @media (max-width: 1200px) {
            .defense-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .sub-agent-status {
                flex-direction: column;
                text-align: center;
            }
            
            .defense-status-bar {
                flex-direction: column;
            }
            
            .playbook-grid {
                grid-template-columns: 1fr;
            }
            
            .ai-chat-window {
                width: calc(100vw - 40px);
                height: calc(100vh - 120px);
                right: -20px;
                bottom: 80px;
            }
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--secondary);
        }
    </style>
</head>
<body>
    <script>
        // Check authentication
        const auth = localStorage.getItem('sentinel_auth');
        if (!auth) {
            window.location.href = 'index.html';
        } else {
            const authData = JSON.parse(auth);
            if (Date.now() - authData.timestamp > 24 * 60 * 60 * 1000) {
                localStorage.removeItem('sentinel_auth');
                window.location.href = 'index.html';
            }
        }
    </script>

    <!-- Animated Background -->
    <div class="animated-bg">
        <div class="dot-grid"></div>
    </div>

    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div class="header-left">
                <div>
                    <h1 class="brand-title">AI SENTINEL-X | ACTIVE DEFENSE</h1>
                    <p class="page-subtitle">DefenseOrchestrator Sub-Agent Active</p>
                </div>
            </div>
            <div class="header-right">
                <div class="agent-status" onclick="showAgentShutdownModal()">
                    <span>🤖 AI Agent Active • Fully Autonomous</span>
                </div>
                <button class="logout-btn" onclick="handleLogout()">Logout</button>
            </div>
        </div>
    </header>

    <!-- Container -->
    <div class="container">
        <!-- Sub-Agent Status -->
        <div class="sub-agent-status">
            <div class="sub-agent-info">
                <div class="sub-agent-icon">⚔️</div>
                <div class="sub-agent-details">
                    <h3>DefenseOrchestrator Sub-Agent</h3>
                    <p>Deploying honeypots • Coordinating responses • Reports to Main Agent</p>
                </div>
            </div>
            <div class="sub-agent-metrics">
                <div class="metric">
                    <div class="metric-value" id="activeHoneypots">8</div>
                    <div class="metric-label">Honeypots</div>
                </div>
                <div class="metric">
                    <div class="metric-value" id="attacksTrapped">47</div>
                    <div class="metric-label">Trapped</div>
                </div>
                <div class="metric">
                    <div class="metric-value" id="responsesExecuted">124</div>
                    <div class="metric-label">Responses</div>
                </div>
            </div>
        </div>

        <!-- Compact Encryption Status -->
        <div class="encryption-compact">
            🔒 CLASSICAL + QUANTUM ACTIVE
        </div>

        <!-- Defense Status Bar -->
        <div class="defense-status-bar">
            <div class="status-item">
                <div class="status-icon">🛡️</div>
                <div class="status-value">ACTIVE</div>
                <div class="status-label">Defense Mode</div>
            </div>
            <div class="status-item">
                <div class="status-icon">⏱️</div>
                <div class="status-value">0.3s</div>
                <div class="status-label">Avg Response</div>
            </div>
            <div class="status-item">
                <div class="status-icon">🎯</div>
                <div class="status-value">99.7%</div>
                <div class="status-label">Success Rate</div>
            </div>
            <div class="status-item">
                <div class="status-icon">🤖</div>
                <div class="status-value">FULL</div>
                <div class="status-label">Automation</div>
            </div>
        </div>

        <!-- Main Grid -->
        <div class="defense-grid">
            <!-- Honeypot Management -->
            <div class="honeypot-panel">
                <div class="panel-header">
                    <h2 class="panel-title">Deception Systems</h2>
                </div>
                <div class="honeypot-list">
                    <div class="honeypot-item" onclick="showHoneypotDetails('ssh')">
                        <div class="honeypot-info">
                            <div class="honeypot-name">
                                <span>🔐</span>
                                <span>SSH Honeypot</span>
                            </div>
                            <div class="honeypot-details">Port 22 • 12 intrusions trapped</div>
                            <div class="honeypot-ai-status">DefenseOrchestrator: Monitoring brute force attempts</div>
                        </div>
                        <div class="honeypot-status">ACTIVE</div>
                    </div>
                    <div class="honeypot-item" onclick="showHoneypotDetails('web')">
                        <div class="honeypot-info">
                            <div class="honeypot-name">
                                <span>🌐</span>
                                <span>Web Application Decoy</span>
                            </div>
                            <div class="honeypot-details">Port 8080 • WordPress simulation</div>
                            <div class="honeypot-ai-status">DefenseOrchestrator: Collecting attack patterns</div>
                        </div>
                        <div class="honeypot-status">ACTIVE</div>
                    </div>
                    <div class="honeypot-item" onclick="showHoneypotDetails('database')">
                        <div class="honeypot-info">
                            <div class="honeypot-name">
                                <span>🗄️</span>
                                <span>Database Honeypot</span>
                            </div>
                            <div class="honeypot-details">Port 3306 • MySQL with fake data</div>
                            <div class="honeypot-ai-status">DefenseOrchestrator: Learning SQL injection patterns</div>
                        </div>
                        <div class="honeypot-status">ACTIVE</div>
                    </div>
                    <div class="honeypot-item" onclick="showHoneypotDetails('ftp')">
                        <div class="honeypot-info">
                            <div class="honeypot-name">
                                <span>📁</span>
                                <span>FTP Server Trap</span>
                            </div>
                            <div class="honeypot-details">Port 21 • Ready to deploy</div>
                            <div class="honeypot-ai-status">DefenseOrchestrator: On standby</div>
                        </div>
                        <div class="honeypot-status status-inactive">STANDBY</div>
                    </div>
                    <div class="honeypot-item" onclick="showHoneypotDetails('email')">
                        <div class="honeypot-info">
                            <div class="honeypot-name">
                                <span>📧</span>
                                <span>Email Server Decoy</span>
                            </div>
                            <div class="honeypot-details">Port 25 • Collecting phishing</div>
                            <div class="honeypot-ai-status">DefenseOrchestrator: 89 phishing attempts trapped</div>
                        </div>
                        <div class="honeypot-status">ACTIVE</div>
                    </div>
                </div>
            </div>

            <!-- Response Timeline -->
            <div class="timeline-panel">
                <div class="panel-header">
                    <h2 class="panel-title">Automated Response Timeline</h2>
                </div>
                <div class="timeline-container" id="responseTimeline">
                    <!-- Timeline events will be populated by JavaScript -->
                </div>
            </div>
        </div>

        <!-- Security Playbooks -->
        <div class="playbooks-section">
            <div class="panel-header">
                <h2 class="panel-title">Active Security Playbooks</h2>
            </div>
            <div class="playbook-grid">
                <div class="playbook-card" onclick="showPlaybookDetails('ddos')">
                    <div class="playbook-icon">⚡</div>
                    <div class="playbook-name">DDoS Mitigation</div>
                    <div class="playbook-stats">Executed 34 times today</div>
                    <div class="playbook-agent">DefenseOrchestrator → ThreatScanner</div>
                </div>
                <div class="playbook-card" onclick="showPlaybookDetails('malware')">
                    <div class="playbook-icon">🦠</div>
                    <div class="playbook-name">Malware Containment</div>
                    <div class="playbook-stats">Executed 12 times today</div>
                    <div class="playbook-agent">DefenseOrchestrator → NetworkMapper</div>
                </div>
                <div class="playbook-card" onclick="showPlaybookDetails('phishing')">
                    <div class="playbook-icon">🎣</div>
                    <div class="playbook-name">Phishing Response</div>
                    <div class="playbook-stats">Executed 89 times today</div>
                    <div class="playbook-agent">DefenseOrchestrator → ThreatScanner</div>
                </div>
                <div class="playbook-card" onclick="showPlaybookDetails('insider')">
                    <div class="playbook-icon">👤</div>
                    <div class="playbook-name">Insider Threat</div>
                    <div class="playbook-stats">Executed 5 times today</div>
                    <div class="playbook-agent">DefenseOrchestrator → LogAgent</div>
                </div>
                <div class="playbook-card" onclick="showPlaybookDetails('ransomware')">
                    <div class="playbook-icon">🔒</div>
                    <div class="playbook-name">Ransomware Defense</div>
                    <div class="playbook-stats">Executed 8 times today</div>
                    <div class="playbook-agent">DefenseOrchestrator → EncryptionManager</div>
                </div>
                <div class="playbook-card" onclick="showPlaybookDetails('zeroday')">
                    <div class="playbook-icon">🎯</div>
                    <div class="playbook-name">Zero-Day Response</div>
                    <div class="playbook-stats">Executed 3 times today</div>
                    <div class="playbook-agent">DefenseOrchestrator → AnalyticsEngine</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Agent Shutdown Modal -->
    <div class="modal-overlay" id="agentShutdownModal" onclick="closeModalOnOverlay(event)">
        <div class="modal">
            <div class="modal-header">
                <h2 class="modal-title">⚠️ Emergency AI Shutdown</h2>
            </div>
            <div class="modal-content">
                Pause autonomous mode? AI actions will be disabled, but manual control remains available through the AI chat bot. If external APIs or keys are offline, the agent will fallback to local control mode.
            </div>
            <div class="modal-actions">
                <button class="modal-btn modal-btn-primary" onclick="confirmAgentShutdown()">Confirm Shutdown</button>
                <button class="modal-btn modal-btn-secondary" onclick="closeModal()">Cancel</button>
            </div>
        </div>
    </div>

    <!-- AI Chat Widget -->
    <div class="ai-chat-widget">
        <div class="ai-chat-window" id="aiChatWindow">
            <div class="ai-chat-header">
                <div class="ai-chat-status">
                    <span class="chat-status-dot"></span>
                    <span>MAIN AGENT ONLINE</span>
                </div>
                <span class="ai-chat-close" onclick="toggleChat()">×</span>
            </div>
            <div class="cli-mode-indicator" id="cliModeIndicator">
                ⚠️ CLI MODE - Main Agent Offline
            </div>
            <div class="ai-chat-messages" id="aiChatMessages">
                <div class="ai-message-bubble">
                    Connected to Main Agent. I can route commands to DefenseOrchestrator for honeypot management and automated responses. All defensive actions are protected with hybrid encryption.
                </div>
                <div class="ai-message-time">Just now</div>
            </div>
            <div class="ai-chat-input-container">
                <input 
                    type="text" 
                    class="ai-chat-input" 
                    id="aiChatInput" 
                    placeholder="Enter command or ask about defenses..."
                    onkeypress="handleChatKeyPress(event)"
                >
                <button class="ai-chat-send" onclick="sendChatMessage()">SEND</button>
            </div>
        </div>
        <div class="ai-chat-toggle" onclick="toggleChat()">🤖</div>
    </div>

    <script src="shared.js"></script>
    <script>
        // Timeline events
        const timelineEvents = [
            { 
                icon: '🛡️', 
                action: 'Blocked Attack', 
                time: new Date(),
                details: 'SQL injection attempt blocked on web honeypot.',
                agent: 'DefenseOrchestrator'
            },
            { 
                icon: '🍯', 
                action: 'Honeypot Triggered', 
                time: new Date(),
                details: 'SSH honeypot accessed from 185.220.101.45.',
                agent: 'DefenseOrchestrator'
            },
            { 
                icon: '🔒', 
                action: 'Ransomware Prevented', 
                time: new Date(),
                details: 'Encryption behavior detected, files backed up.',
                agent: 'DefenseOrchestrator → EncryptionManager'
            },
            { 
                icon: '📧', 
                action: 'Phishing Blocked', 
                time: new Date(),
                details: '23 emails quarantined by email honeypot.',
                agent: 'DefenseOrchestrator'
            },
            { 
                icon: '🎯', 
                action: 'Zero-Day Mitigated', 
                time: new Date(),
                details: 'Unknown exploit detected, virtual patch deployed.',
                agent: 'DefenseOrchestrator → AnalyticsEngine'
            },
            { 
                icon: '⚡', 
                action: 'DDoS Deflected', 
                time: new Date(),
                details: '45,000 req/sec mitigated autonomously.',
                agent: 'DefenseOrchestrator → ThreatScanner'
            }
        ];

        // Add timeline event
        function addTimelineEvent(event) {
            const timeline = document.getElementById('responseTimeline');
            const eventDiv = document.createElement('div');
            eventDiv.className = 'timeline-event';
            
            const time = event.time.toLocaleTimeString();
            
            eventDiv.innerHTML = `
                <div class="timeline-icon">${event.icon}</div>
                <div class="timeline-content">
                    <div class="timeline-time">${time}</div>
                    <div class="timeline-action">${event.action}</div>
                    <div class="timeline-details">${event.details}</div>
                    <div class="timeline-agent">Handled by: ${event.agent}</div>
                </div>
            `;
            
            timeline.insertBefore(eventDiv, timeline.firstChild);
            
            // Keep only last 10 events
            while (timeline.children.length > 10) {
                timeline.removeChild(timeline.lastChild);
            }
        }

        // Show honeypot details
        function showHoneypotDetails(honeypot) {
            if (!chatOpen) {
                toggleChat();
            }
            setTimeout(() => {
                addChatMessage(`Routing to DefenseOrchestrator sub-agent...`, false, 'system');
                setTimeout(() => {
                    const details = {
                        'ssh': 'SSH Honeypot: 3 active sessions being monitored. 147 login attempts logged. All data encrypted with AES-256-GCM + Kyber-1024.',
                        'web': 'Web Decoy: WordPress 4.5 simulation capturing SQL injections. Session data protected with hybrid encryption.',
                        'database': 'Database Honeypot: MySQL with fake customer records. DefenseOrchestrator learning attack patterns in real-time.',
                        'ftp': 'FTP Trap: On standby. Ready to deploy on Main Agent command.',
                        'email': 'Email Decoy: 89 phishing emails trapped. DefenseOrchestrator analyzing patterns with AnalyticsEngine.'
                    };
                    addChatMessage(`DefenseOrchestrator: ${details[honeypot]}`, false);
                }, 800);
            }, 300);
        }

        // Show playbook details
        function showPlaybookDetails(playbook) {
            if (!chatOpen) {
                toggleChat();
            }
            setTimeout(() => {
                const details = {
                    'ddos': 'DDoS Playbook: Rate limiting + traffic filtering. DefenseOrchestrator coordinates with ThreatScanner. Mitigation time: 1.2s.',
                    'malware': 'Malware Playbook: Instant isolation by DefenseOrchestrator. NetworkMapper identifies infected hosts. All samples encrypted.',
                    'phishing': 'Phishing Playbook: Email quarantine + user alerts. DefenseOrchestrator works with ThreatScanner. 89 attacks blocked today.',
                    'insider': 'Insider Threat: Evidence collection by LogAgent. DefenseOrchestrator ensures chain of custody with Dilithium signatures.',
                    'ransomware': 'Ransomware Defense: Instant backup by EncryptionManager. DefenseOrchestrator coordinates response. Zero data loss.',
                    'zeroday': 'Zero-Day Response: Virtual patches deployed. DefenseOrchestrator + AnalyticsEngine predict attack patterns.'
                };
                addChatMessage(`DefenseOrchestrator: ${details[playbook]}`, false);
            }, 300);
        }

        // Update metrics
        function updateMetrics() {
            const trapped = document.getElementById('attacksTrapped');
            trapped.textContent = parseInt(trapped.textContent) + Math.floor(Math.random() * 3);
            
            const responses = document.getElementById('responsesExecuted');
            responses.textContent = parseInt(responses.textContent) + 1;
        }

        // Logout handler
        function handleLogout() {
            if (confirm('Logout? The AI agent will continue protecting your systems.')) {
                localStorage.removeItem('sentinel_auth');
                window.location.href = 'index.html';
            }
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            // Add initial timeline events
            for (let i = 0; i < 4; i++) {
                const event = timelineEvents[Math.floor(Math.random() * timelineEvents.length)];
                addTimelineEvent(event);
            }
            
            // Auto-generate events
            setInterval(() => {
                const event = timelineEvents[Math.floor(Math.random() * timelineEvents.length)];
                event.time = new Date();
                addTimelineEvent(event);
                updateMetrics();
            }, 10000);
        });
    </script>
</body>
</html>
