<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Network Discovery | AI Sentinel-X</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #00ff88;
            --secondary: #00ccff;
            --accent: #7c3aed;
            --danger: #ff0044;
            --warning: #ffaa00;
            --success: #00ff88;
            --bg-dark: #0a0e1a;
            --bg-darker: #060912;
            --bg-card: rgba(10, 20, 40, 0.8);
            --border: rgba(0, 255, 136, 0.2);
            --text-primary: #ffffff;
            --text-secondary: #8892b0;
            --gradient-1: linear-gradient(135deg, #00ff88 0%, #00ccff 100%);
            --gradient-network: linear-gradient(135deg, #00ccff 0%, #0066ff 100%);
            --gradient-quantum: linear-gradient(135deg, #7c3aed 0%, #ff00ff 50%, #00ccff 100%);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Consolas', 'Monaco', monospace;
            background: var(--bg-darker);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Animated Dot Background */
        .animated-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
            overflow: hidden;
        }

        .dot-grid {
            position: absolute;
            width: 100%;
            height: 100%;
            background-image: radial-gradient(circle, rgba(0, 255, 136, 0.15) 1px, transparent 1px);
            background-size: 30px 30px;
            animation: dotMove 40s linear infinite;
        }

        @keyframes dotMove {
            0% { transform: translate(0, 0); }
            100% { transform: translate(30px, 30px); }
        }

        /* Header */
        .header {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 15px;
            padding: 20px 30px;
            margin: 20px;
            backdrop-filter: blur(15px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
            position: relative;
            z-index: 10;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .brand-title {
            font-size: 24px;
            font-weight: bold;
            background: var(--gradient-1);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            letter-spacing: 2px;
        }

        .page-subtitle {
            color: var(--text-secondary);
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .header-right {
            display: flex;
            gap: 20px;
            align-items: center;
        }

        .agent-status {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 10px 20px;
            background: rgba(0, 255, 136, 0.1);
            border: 1px solid var(--primary);
            border-radius: 30px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .agent-status:hover {
            background: rgba(0, 255, 136, 0.2);
            transform: translateY(-2px);
        }

        .logout-btn {
            background: transparent;
            border: 1px solid rgba(255, 0, 68, 0.3);
            border-radius: 8px;
            padding: 10px 20px;
            color: var(--danger);
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .logout-btn:hover {
            background: rgba(255, 0, 68, 0.1);
        }

        /* Container */
        .container {
            position: relative;
            z-index: 1;
            max-width: 1800px;
            margin: 0 auto;
            padding: 0 20px 20px 20px;
        }

        /* Sub-Agent Status */
        .sub-agent-status {
            background: linear-gradient(135deg, rgba(0, 204, 255, 0.1) 0%, rgba(0, 255, 136, 0.05) 100%);
            border: 1px solid rgba(0, 204, 255, 0.3);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 25px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
        }

        .sub-agent-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .sub-agent-icon {
            width: 50px;
            height: 50px;
            background: var(--gradient-network);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            box-shadow: 0 4px 20px rgba(0, 204, 255, 0.3);
        }

        .sub-agent-details h3 {
            font-size: 18px;
            color: var(--secondary);
            margin-bottom: 5px;
        }

        .sub-agent-details p {
            font-size: 14px;
            color: var(--text-secondary);
        }

        .sub-agent-metrics {
            display: flex;
            gap: 30px;
        }

        .metric {
            text-align: center;
        }

        .metric-value {
            font-size: 24px;
            font-weight: bold;
            color: var(--secondary);
        }

        .metric-label {
            font-size: 12px;
            color: var(--text-secondary);
            text-transform: uppercase;
        }

        /* Compact Encryption Status */
        .encryption-compact {
            background: rgba(124, 58, 237, 0.1);
            border: 1px solid rgba(124, 58, 237, 0.3);
            border-radius: 8px;
            padding: 12px 20px;
            margin-bottom: 25px;
            text-align: center;
            font-size: 14px;
            color: var(--accent);
            font-weight: 600;
        }

        /* Network Overview */
        .network-overview {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            backdrop-filter: blur(20px);
        }

        .overview-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--border);
        }

        .overview-title {
            font-size: 22px;
            font-weight: bold;
            color: var(--primary);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .scan-status {
            display: flex;
            align-items: center;
            gap: 10px;
            color: var(--success);
            font-size: 14px;
            font-weight: bold;
        }

        .status-dot {
            width: 10px;
            height: 10px;
            background: var(--success);
            border-radius: 50%;
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.3); opacity: 0.7; }
        }

        .overview-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .overview-card {
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.4) 0%, rgba(0, 204, 255, 0.02) 100%);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .overview-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0, 204, 255, 0.2);
        }

        .overview-icon {
            font-size: 36px;
            margin-bottom: 15px;
        }

        .overview-value {
            font-size: 28px;
            font-weight: bold;
            color: var(--secondary);
            margin-bottom: 8px;
        }

        .overview-label {
            font-size: 13px;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* Device Grid */
        .device-section {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 15px;
            padding: 30px;
            backdrop-filter: blur(20px);
        }

        .device-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 20px;
            margin-top: 25px;
        }

        .device-card {
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.4) 0%, rgba(0, 255, 136, 0.02) 100%);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .device-card:hover {
            background: linear-gradient(135deg, rgba(0, 255, 136, 0.05) 0%, rgba(0, 204, 255, 0.05) 100%);
            border-color: var(--primary);
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(0, 255, 136, 0.2);
        }

        .device-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .device-icon {
            font-size: 32px;
        }

        .device-status {
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 11px;
            font-weight: bold;
            text-transform: uppercase;
        }

        .status-secure {
            background: rgba(0, 255, 136, 0.2);
            color: var(--success);
        }

        .status-warning {
            background: rgba(255, 170, 0, 0.2);
            color: var(--warning);
        }

        .status-critical {
            background: rgba(255, 0, 68, 0.2);
            color: var(--danger);
        }

        .device-name {
            font-weight: bold;
            font-size: 16px;
            color: var(--primary);
            margin-bottom: 5px;
        }

        .device-ip {
            font-size: 14px;
            color: var(--text-secondary);
            font-family: 'Courier New', monospace;
            margin-bottom: 10px;
        }

        .device-info {
            font-size: 13px;
            color: var(--text-secondary);
            line-height: 1.5;
        }

        .device-ai-status {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 12px;
            color: var(--accent);
            font-style: italic;
        }

        /* Scan Controls */
        .scan-controls {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 25px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
            backdrop-filter: blur(15px);
        }

        .scan-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .scan-actions {
            display: flex;
            gap: 15px;
        }

        .scan-btn {
            background: rgba(0, 204, 255, 0.1);
            border: 1px solid var(--secondary);
            border-radius: 8px;
            padding: 10px 20px;
            color: var(--secondary);
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            text-transform: uppercase;
            font-size: 13px;
        }

        .scan-btn:hover {
            background: var(--secondary);
            color: var(--bg-darker);
            transform: translateY(-2px);
        }

        /* AI Chat Widget */
        .ai-chat-widget {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 1000;
        }

        .ai-chat-toggle {
            width: 60px;
            height: 60px;
            background: var(--gradient-1);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 5px 20px rgba(0, 255, 136, 0.4);
            transition: all 0.3s ease;
            font-size: 28px;
        }

        .ai-chat-toggle:hover {
            transform: scale(1.1);
        }

        .ai-chat-window {
            position: absolute;
            bottom: 80px;
            right: 0;
            width: 400px;
            height: 600px;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 20px;
            display: none;
            flex-direction: column;
            overflow: hidden;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(20px);
        }

        .ai-chat-window.active {
            display: flex;
            animation: chatSlideIn 0.3s ease;
        }

        @keyframes chatSlideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .ai-chat-header {
            background: var(--gradient-1);
            color: var(--bg-darker);
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: bold;
        }

        .ai-chat-status {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 14px;
        }

        .chat-status-dot {
            width: 8px;
            height: 8px;
            background: var(--bg-darker);
            border-radius: 50%;
            animation: pulse 2s ease-in-out infinite;
        }

        .ai-chat-close {
            cursor: pointer;
            font-size: 24px;
        }

        .cli-mode-indicator {
            background: rgba(255, 170, 0, 0.1);
            border: 1px solid var(--warning);
            border-radius: 8px;
            padding: 10px;
            margin: 0 20px;
            text-align: center;
            font-size: 12px;
            color: var(--warning);
            display: none;
        }

        .cli-mode-indicator.active {
            display: block;
        }

        .ai-chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .ai-message-bubble {
            background: rgba(0, 255, 136, 0.1);
            border: 1px solid var(--border);
            border-radius: 15px;
            padding: 15px 20px;
            max-width: 80%;
            word-wrap: break-word;
        }

        .ai-message-bubble.user {
            background: rgba(0, 204, 255, 0.1);
            border-color: var(--secondary);
            align-self: flex-end;
        }

        .ai-message-bubble.system {
            background: rgba(124, 58, 237, 0.1);
            border-color: var(--accent);
            font-size: 13px;
            font-style: italic;
        }

        .ai-message-time {
            font-size: 11px;
            color: var(--text-secondary);
            margin-top: 5px;
        }

        .ai-chat-input-container {
            padding: 20px;
            border-top: 1px solid var(--border);
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .ai-chat-input {
            flex: 1;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--border);
            border-radius: 10px;
            padding: 12px 15px;
            color: var(--text-primary);
            font-size: 14px;
        }

        .ai-chat-input:focus {
            outline: none;
            border-color: var(--primary);
        }

        .ai-chat-send {
            background: var(--gradient-1);
            border: none;
            border-radius: 10px;
            padding: 12px 20px;
            color: var(--bg-darker);
            font-weight: bold;
            cursor: pointer;
            text-transform: uppercase;
        }

        /* Agent Shutdown Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            backdrop-filter: blur(5px);
        }

        .modal {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 20px;
            padding: 40px;
            max-width: 500px;
            width: 90%;
            backdrop-filter: blur(20px);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            animation: modalSlideIn 0.3s ease;
        }

        @keyframes modalSlideIn {
            from { opacity: 0; transform: translateY(-20px) scale(0.95); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }

        .modal-header {
            text-align: center;
            margin-bottom: 25px;
        }

        .modal-title {
            font-size: 24px;
            font-weight: bold;
            color: var(--warning);
            margin-bottom: 10px;
        }

        .modal-content {
            color: var(--text-secondary);
            line-height: 1.6;
            margin-bottom: 30px;
        }

        .modal-actions {
            display: flex;
            gap: 15px;
            justify-content: center;
        }

        .modal-btn {
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .modal-btn-primary {
            background: var(--gradient-1);
            color: var(--bg-darker);
        }

        .modal-btn-secondary {
            background: transparent;
            border: 2px solid var(--border);
            color: var(--text-secondary);
        }

        .modal-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .device-grid {
                grid-template-columns: 1fr;
            }
            
            .sub-agent-status {
                flex-direction: column;
                text-align: center;
            }
            
            .scan-controls {
                flex-direction: column;
                text-align: center;
            }
            
            .ai-chat-window {
                width: calc(100vw - 40px);
                height: calc(100vh - 120px);
                right: -20px;
                bottom: 80px;
            }
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb {
            background: var(--secondary);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--primary);
        }
    </style>
</head>
<body>
    <script>
        // Check authentication
        const auth = localStorage.getItem('sentinel_auth');
        if (!auth) {
            window.location.href = 'index.html';
        } else {
            const authData = JSON.parse(auth);
            if (Date.now() - authData.timestamp > 24 * 60 * 60 * 1000) {
                localStorage.removeItem('sentinel_auth');
                window.location.href = 'index.html';
            }
        }
    </script>

    <!-- Animated Background -->
    <div class="animated-bg">
        <div class="dot-grid"></div>
    </div>

    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div class="header-left">
                <div>
                    <h1 class="brand-title">AI SENTINEL-X | NETWORK DISCOVERY</h1>
                    <p class="page-subtitle">NetworkMapper Sub-Agent Active</p>
                </div>
            </div>
            <div class="header-right">
                <div class="agent-status" onclick="showAgentShutdownModal()">
                    <span>ü§ñ AI Agent Active ‚Ä¢ Fully Autonomous</span>
                </div>
                <button class="logout-btn" onclick="handleLogout()">Logout</button>
            </div>
        </div>
    </header>

    <!-- Container -->
    <div class="container">
        <!-- Sub-Agent Status -->
        <div class="sub-agent-status">
            <div class="sub-agent-info">
                <div class="sub-agent-icon">üåê</div>
                <div class="sub-agent-details">
                    <h3>NetworkMapper Sub-Agent</h3>
                    <p>Auto-discovering devices via Shodan API ‚Ä¢ Reports to Main Agent</p>
                </div>
            </div>
            <div class="sub-agent-metrics">
                <div class="metric">
                    <div class="metric-value" id="totalDevices">247</div>
                    <div class="metric-label">Total Devices</div>
                </div>
                <div class="metric">
                    <div class="metric-value" id="newDevices">12</div>
                    <div class="metric-label">New Today</div>
                </div>
                <div class="metric">
                    <div class="metric-value" id="vulnerableDevices">18</div>
                    <div class="metric-label">Need Attention</div>
                </div>
            </div>
        </div>

        <!-- Compact Encryption Status -->
        <div class="encryption-compact">
            üîí CLASSICAL + QUANTUM ACTIVE
        </div>

        <!-- Scan Controls -->
        <div class="scan-controls">
            <div class="scan-info">
                <div class="status-dot"></div>
                <div>
                    <div style="font-weight: bold; margin-bottom: 5px;">Auto-Discovery Active</div>
                    <div style="font-size: 13px; color: var(--text-secondary);">External scan via Shodan ‚Ä¢ Internal scan via deployed agent</div>
                </div>
            </div>
            <div class="scan-actions">
                <button class="scan-btn" onclick="forceScan()">Force Scan</button>
                <button class="scan-btn" onclick="viewScanConfig()">Scan Config</button>
            </div>
        </div>

        <!-- Network Overview -->
        <div class="network-overview">
            <div class="overview-header">
                <h2 class="overview-title">Network Overview</h2>
                <div class="scan-status">
                    <div class="status-dot"></div>
                    <span>SCANNING</span>
                </div>
            </div>
            
            <div class="overview-grid">
                <div class="overview-card">
                    <div class="overview-icon">üåê</div>
                    <div class="overview-value" id="publicIP">45.67.89.123</div>
                    <div class="overview-label">Public IP Address</div>
                </div>
                <div class="overview-card">
                    <div class="overview-icon">üè†</div>
                    <div class="overview-value">192.168.1.0/24</div>
                    <div class="overview-label">Internal Network</div>
                </div>
                <div class="overview-card">
                    <div class="overview-icon">üö™</div>
                    <div class="overview-value" id="openPorts">42</div>
                    <div class="overview-label">Open Ports</div>
                </div>
                <div class="overview-card">
                    <div class="overview-icon">üõ°Ô∏è</div>
                    <div class="overview-value">89%</div>
                    <div class="overview-label">Security Score</div>
                </div>
            </div>
        </div>

        <!-- Device Discovery -->
        <div class="device-section">
            <div class="overview-header">
                <h2 class="overview-title">Discovered Devices</h2>
                <span style="color: var(--text-secondary); font-size: 14px;">Real-time updates from NetworkMapper</span>
            </div>
            
            <div class="device-grid" id="deviceGrid">
                <!-- Devices will be populated by JavaScript -->
            </div>
        </div>
    </div>

    <!-- Agent Shutdown Modal -->
    <div class="modal-overlay" id="agentShutdownModal" onclick="closeModalOnOverlay(event)">
        <div class="modal">
            <div class="modal-header">
                <h2 class="modal-title">‚ö†Ô∏è Emergency AI Shutdown</h2>
            </div>
            <div class="modal-content">
                Pause autonomous mode? AI actions will be disabled, but manual control remains available through the AI chat bot. If external APIs or keys are offline, the agent will fallback to local control mode.
            </div>
            <div class="modal-actions">
                <button class="modal-btn modal-btn-primary" onclick="confirmAgentShutdown()">Confirm Shutdown</button>
                <button class="modal-btn modal-btn-secondary" onclick="closeModal()">Cancel</button>
            </div>
        </div>
    </div>

    <!-- AI Chat Widget -->
    <div class="ai-chat-widget">
        <div class="ai-chat-window" id="aiChatWindow">
            <div class="ai-chat-header">
                <div class="ai-chat-status">
                    <span class="chat-status-dot"></span>
                    <span>MAIN AGENT ONLINE</span>
                </div>
                <span class="ai-chat-close" onclick="toggleChat()">√ó</span>
            </div>
            <div class="cli-mode-indicator" id="cliModeIndicator">
                ‚ö†Ô∏è CLI MODE - Main Agent Offline
            </div>
            <div class="ai-chat-messages" id="aiChatMessages">
                <div class="ai-message-bubble">
                    Connected to Main Agent. I can route commands to NetworkMapper for device discovery. External scanning uses Shodan API, internal uses deployed agent. All data protected with hybrid encryption.
                </div>
                <div class="ai-message-time">Just now</div>
            </div>
            <div class="ai-chat-input-container">
                <input 
                    type="text" 
                    class="ai-chat-input" 
                    id="aiChatInput" 
                    placeholder="Enter command or ask about network..."
                    onkeypress="handleChatKeyPress(event)"
                >
                <button class="ai-chat-send" onclick="sendChatMessage()">SEND</button>
            </div>
        </div>
        <div class="ai-chat-toggle" onclick="toggleChat()">ü§ñ</div>
    </div>

    <script src="shared.js"></script>
    <script>
        // Device data
        const devices = [
            {
                name: 'DC-PRIMARY',
                ip: '192.168.1.10',
                type: 'Domain Controller',
                icon: 'üñ•Ô∏è',
                status: 'secure',
                services: 'AD, DNS, DHCP',
                aiStatus: 'Monitored by NetworkMapper. All services encrypted.',
                lastSeen: 'Active'
            },
            {
                name: 'FILE-SERVER-01',
                ip: '192.168.1.20',
                type: 'File Server',
                icon: 'üìÅ',
                status: 'warning',
                services: 'SMB, FTP',
                aiStatus: 'NetworkMapper detected outdated SMB version.',
                lastSeen: 'Active'
            },
            {
                name: 'DB-PROD-01',
                ip: '192.168.1.30',
                type: 'Database Server',
                icon: 'üóÑÔ∏è',
                status: 'secure',
                services: 'MySQL 8.0',
                aiStatus: 'Fully encrypted. NetworkMapper verified TLS.',
                lastSeen: 'Active'
            },
            {
                name: 'WEB-APP-01',
                ip: '192.168.1.40',
                type: 'Web Server',
                icon: 'üåê',
                status: 'secure',
                services: 'HTTPS, SSH',
                aiStatus: 'NetworkMapper confirmed TLS 1.3 + Kyber.',
                lastSeen: 'Active'
            },
            {
                name: 'SECURITY-CAM-01',
                ip: '192.168.1.50',
                type: 'IoT Device',
                icon: 'üìπ',
                status: 'critical',
                services: 'RTSP, HTTP',
                aiStatus: 'NetworkMapper flagged: No encryption support!',
                lastSeen: '2 min ago'
            },
            {
                name: 'WORKSTATION-101',
                ip: '192.168.1.101',
                type: 'Workstation',
                icon: 'üíª',
                status: 'warning',
                services: 'RDP, SMB',
                aiStatus: 'NetworkMapper: Pending OS updates detected.',
                lastSeen: 'Active'
            },
            {
                name: 'PRINTER-FINANCE',
                ip: '192.168.1.200',
                type: 'Network Printer',
                icon: 'üñ®Ô∏è',
                status: 'critical',
                services: 'IPP, SNMP',
                aiStatus: 'NetworkMapper alert: Default credentials!',
                lastSeen: '5 min ago'
            },
            {
                name: 'HVAC-CONTROLLER',
                ip: '192.168.1.230',
                type: 'Building System',
                icon: 'üå°Ô∏è',
                status: 'warning',
                services: 'BACnet, HTTP',
                aiStatus: 'NetworkMapper monitoring for anomalies.',
                lastSeen: 'Active'
            },
            {
                name: 'AP-FLOOR-3',
                ip: '192.168.1.240',
                type: 'Access Point',
                icon: 'üì°',
                status: 'secure',
                services: 'WiFi 6, RADIUS',
                aiStatus: 'NetworkMapper verified WPA3 + 802.1X.',
                lastSeen: 'Active'
            }
        ];

        // Populate devices
        function populateDevices() {
            const grid = document.getElementById('deviceGrid');
            grid.innerHTML = '';
            
            devices.forEach((device, index) => {
                const card = document.createElement('div');
                card.className = 'device-card';
                card.innerHTML = `
                    <div class="device-header">
                        <div class="device-icon">${device.icon}</div>
                        <div class="device-status status-${device.status}">${device.status}</div>
                    </div>
                    <div class="device-name">${device.name}</div>
                    <div class="device-ip">${device.ip}</div>
                    <div class="device-info">
                        <div><strong>Type:</strong> ${device.type}</div>
                        <div><strong>Services:</strong> ${device.services}</div>
                        <div><strong>Last Seen:</strong> ${device.lastSeen}</div>
                    </div>
                    <div class="device-ai-status">
                        ü§ñ ${device.aiStatus}
                    </div>
                `;
                
                card.onclick = () => showDeviceDetails(device);
                grid.appendChild(card);
            });
        }

        // Show device details
        function showDeviceDetails(device) {
            if (!chatOpen) {
                toggleChat();
            }
            setTimeout(() => {
                addChatMessage(`Routing to NetworkMapper sub-agent...`, false, 'system');
                setTimeout(() => {
                    let message = `NetworkMapper: ${device.name} (${device.ip}) - ${device.type}. Services: ${device.services}. `;
                    if (device.status === 'critical') {
                        message += `‚ö†Ô∏è CRITICAL: ${device.aiStatus} Immediate action recommended!`;
                    } else if (device.status === 'warning') {
                        message += `‚ö†Ô∏è WARNING: ${device.aiStatus}`;
                    } else {
                        message += `‚úÖ ${device.aiStatus}`;
                    }
                    addChatMessage(message, false);
                }, 800);
            }, 300);
        }

        // Force scan
        function forceScan() {
            addChatMessage('Initiating forced network scan...', false, 'system');
            setTimeout(() => {
                addChatMessage('NetworkMapper: External scan via Shodan API initiated. Internal agent scanning 192.168.1.0/24. Results will appear in real-time.', false);
                
                // Simulate finding new device
                setTimeout(() => {
                    const newDevices = document.getElementById('newDevices');
                    newDevices.textContent = parseInt(newDevices.textContent) + 1;
                    addChatMessage('NetworkMapper: New device discovered - LAPTOP-GUEST (192.168.1.250)', false);
                }, 3000);
            }, 1000);
        }

        // View scan config
        function viewScanConfig() {
            if (!chatOpen) {
                toggleChat();
            }
            setTimeout(() => {
                addChatMessage(`NetworkMapper configuration:
‚Ä¢ External: Shodan API (Rate: 1 scan/hour)
‚Ä¢ Internal: Agent-based ARP + service discovery
‚Ä¢ Encryption: All data uses AES-256-GCM + Kyber-1024
‚Ä¢ Auto-discovery: Every 5 minutes
‚Ä¢ New device alerts: Instant`, false);
            }, 300);
        }

        // Update metrics
        function updateMetrics() {
            // Occasionally find new devices
            if (Math.random() > 0.9) {
                const total = document.getElementById('totalDevices');
                total.textContent = parseInt(total.textContent) + 1;
                
                const newDev = document.getElementById('newDevices');
                newDev.textContent = parseInt(newDev.textContent) + 1;
            }
            
            // Update vulnerable devices
            if (Math.random() > 0.95) {
                const vuln = document.getElementById('vulnerableDevices');
                vuln.textContent = Math.max(0, parseInt(vuln.textContent) + Math.floor(Math.random() * 3 - 1));
            }
        }

        // Logout handler
        function handleLogout() {
            if (confirm('Logout? The AI agent will continue protecting your systems.')) {
                localStorage.removeItem('sentinel_auth');
                window.location.href = 'index.html';
            }
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            populateDevices();
            
            // Update metrics
            setInterval(updateMetrics, 5000);
            
            // Simulate discovery events
            setInterval(() => {
                if (Math.random() > 0.8) {
                    const messages = [
                        'NetworkMapper: Port scan detected on 192.168.1.105',
                        'NetworkMapper: New service discovered on FILE-SERVER-01',
                        'NetworkMapper: Device offline - PRINTER-ACCOUNTING',
                        'NetworkMapper: Shodan API found exposed port 3389',
                        'NetworkMapper: All devices rescanned - 247 active'
                    ];
                    if (chatOpen) {
                        addChatMessage(messages[Math.floor(Math.random() * messages.length)], false);
                    }
                }
            }, 15000);
        });
    </script>
</body>
</html>
